(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"7JYj":function(t,n,i){"use strict";i.d(n,"a",(function(){return o}));var e=i("fXoL");let o=(()=>{class t{}return t.\u0275mod=e.Fb({type:t}),t.\u0275inj=e.Eb({factory:function(n){return new(n||t)},imports:[[]]}),t})()},NPEJ:function(t,n,i){"use strict";i.r(n),i.d(n,"ProductListPageModule",(function(){return y}));var e=i("ofXK"),o=i("3Pt+"),r=i("tyNb"),a=i("TEn/"),c=i("mrSG"),s=i("VVxe"),b=i("LvDl"),d=i("PLH8"),l=i("dkQB"),h=i("sybk"),g=i("7K7q"),u=i("fXoL"),f=i("sYmb"),p=i("otYU");function m(t,n){1&t&&(u.Kb(0,"ion-card",13),u.Kb(1,"ion-card-content",14),u.Ib(2,"p",15),u.Vb(3,"translate"),u.Jb(),u.Jb()),2&t&&(u.xb(2),u.ac("innerHTML",u.Wb(3,1,"app.pages.product.html.daysnotice"),u.gc))}function C(t,n){1&t&&u.Ib(0,"ion-spinner",16)}function x(t,n){if(1&t&&(u.Kb(0,"span"),u.Kb(1,"ion-badge",23),u.kc(2),u.Jb(),u.Kb(3,"ion-badge",24),u.Ib(4,"ion-icon",25),u.kc(5),u.Jb(),u.Jb()),2&t){const t=n.$implicit;u.xb(2),u.mc(" ",t.get("tag").get("name_es")," "),u.xb(3),u.mc(" ",t.get("tag").get("name_es")," ")}}function P(t,n){if(1&t&&(u.Kb(0,"div"),u.jc(1,x,6,2,"span",7),u.Jb()),2&t){const t=u.Ub().$implicit;u.xb(1),u.ac("ngForOf",t.tags)}}function M(t,n){if(1&t){const t=u.Lb();u.Kb(0,"article"),u.Kb(1,"ion-card",17),u.Sb("click",(function(){u.fc(t);const i=n.$implicit;return u.Ub().goToProduct(i)})),u.Ib(2,"ion-img",18),u.Vb(3,"cloudinaryPipe"),u.Kb(4,"ion-card-title",19),u.kc(5),u.Jb(),u.Kb(6,"ion-card-subtitle",19),u.kc(7),u.Jb(),u.Ib(8,"div",20),u.Kb(9,"ion-card-content"),u.jc(10,P,2,1,"div",21),u.Kb(11,"ion-badge",22),u.Kb(12,"h3"),u.Kb(13,"strong"),u.kc(14),u.Vb(15,"number"),u.Jb(),u.Jb(),u.Jb(),u.Jb(),u.Jb(),u.Jb()}if(2&t){const t=n.$implicit,i=u.Ub();u.xb(2),u.ac("src",u.Xb(3,5,t.get("imgUrls")[0],"rectangleFill")),u.xb(3),u.mc(" ",t.get("name_es")," "),u.xb(2),u.mc(" ",t.get("presentation_es")," "),u.xb(3),u.ac("ngIf",i.loadTags&&(null==t.tags?null:t.tags.length)>0),u.xb(4),u.mc("\u20a1 ",u.Wb(15,8,t.get("price_cr")),"")}}function v(t,n){if(1&t){const t=u.Lb();u.Kb(0,"ion-button",26),u.Sb("click",(function(){return u.fc(t),u.Ub().loadMore()})),u.kc(1),u.Vb(2,"translate"),u.Jb()}2&t&&(u.xb(1),u.mc(" ",u.Wb(2,1,"app.label.loadmore")," "))}function _(t,n){if(1&t){const t=u.Lb();u.Kb(0,"div",27),u.Kb(1,"ion-button",28),u.Sb("click",(function(){return u.fc(t),u.Ub().scrollToTop()})),u.Ib(2,"ion-icon",29),u.Jb(),u.Jb()}}const O=function(){return["/cart-list"]};function I(t,n){1&t&&(u.Kb(0,"ion-fab",30),u.Kb(1,"ion-fab-button",31),u.Ib(2,"ion-icon",32),u.Jb(),u.Jb()),2&t&&(u.xb(1),u.ac("routerLink",u.cc(1,O)))}function J(t,n){if(1&t){const t=u.Lb();u.Kb(0,"ion-infinite-scroll",33),u.Sb("ionInfinite",(function(){return u.fc(t),u.Ub().loadMore()})),u.Ib(1,"ion-infinite-scroll-content",34),u.Jb()}}let K=(()=>{class t{constructor(t,n,i,e,o,r,a){this.route=t,this.router=n,this.keyboard=i,this.productService=e,this.loadingCtrl=o,this.alertCtrl=r,this.authService=a,this.brandUrlId=this.route.snapshot.paramMap.get("brandUrlId")||"all",this.loadTags=!1,this.searchCriteria="",this.daList=[],this.ionRefresher=!1}ngOnInit(){return Object(c.a)(this,void 0,void 0,(function*(){this.authService.cast.subscribe(t=>{this.currentUser=t}),this.resetPagination(),this.search()}))}doRefresh(t){return Object(c.a)(this,void 0,void 0,(function*(){this.ionRefresher=!0,yield this.ngOnInit(),t.target.complete(),this.ionRefresher=!1}))}resetPagination(){this.useInfiniteScroll=!1,this.fetchingPage=!1,this.page=0,this.lastPage=!1}search(){return new Promise((t,n)=>Object(c.a)(this,void 0,void 0,(function*(){this.loading=!this.useInfiniteScroll&&!this.ionRefresher;try{this.searchCriteria=s(this.searchCriteria)}catch(i){}this.productService.GetBrandProductsBySearchCriteria(this.brandUrlId,this.page,l.a.SETTINGS.PAGE_SIZE,this.searchCriteria).then(n=>{this.useInfiniteScroll?Object(b.each)(n,t=>Object(c.a)(this,void 0,void 0,(function*(){this.daList.push(t),this.loadTags&&(t.tags=yield this.productService.GetTagsForProduct(t.id))}))):(this.daList=n,this.loadTags&&Object(b.each)(this.daList,t=>Object(c.a)(this,void 0,void 0,(function*(){t.tags=yield this.productService.GetTagsForProduct(t.id)})))),this.loading=!1,t(n)}).catch(t=>{console.error(t),this.loading=!1,this.daList=[],n(t)})})))}loadMore(){return Object(c.a)(this,void 0,void 0,(function*(){this.fetchingPage||(this.useInfiniteScroll=!0,this.fetchingPage=!0,this.page++,this.search().then(t=>{this.useInfiniteScroll=!1,this.fetchingPage=!1,this.infiniteScroll.complete(),t&&(this.lastPage=0===t.length),console.log("loaded page ",this.page)}).catch(t=>{console.error(t),this.infiniteScroll.complete()}))}))}goToProduct(t){this.router.navigate(["/product/"+t.get("urlId")])}criteriaChanged(){this.resetPagination(),this.search()}clearSearchBar(){this.searchCriteria="",this.hideKeyboard(),this.scrollToTop(),this.resetPagination(),this.search()}hideKeyboard(){this.keyboard.hide()}scrollToTop(){this.content.scrollToTop(1e3)}}return t.\u0275fac=function(n){return new(n||t)(u.Hb(r.a),u.Hb(r.f),u.Hb(d.a),u.Hb(g.a),u.Hb(a.U),u.Hb(a.a),u.Hb(h.a))},t.\u0275cmp=u.Bb({type:t,selectors:[["app-product-list"]],viewQuery:function(t,n){var i;1&t&&(u.nc(a.o,!0),u.nc(a.u,!0)),2&t&&(u.ec(i=u.Tb())&&(n.content=i.first),u.ec(i=u.Tb())&&(n.infiniteScroll=i.first))},features:[u.wb([d.a])],decls:21,vars:15,consts:[["color","primary"],["slot","start"],["inputmode","text","searchIcon","search-outline",1,"ion-no-margin",3,"placeholder","debounce","ngModel","ionChange","ngModelChange"],["slot","fixed","pullFactor","0.8","pullMin","60","pullMax","120",3,"ionRefresh"],["class","animate__animated animate__fadeIn","color","cream",4,"ngIf"],["class","center3 mt-4","name","crescent",4,"ngIf"],[1,"cards"],[4,"ngFor","ngForOf"],[1,"loadMoreBtn","ion-margin","text-center"],["shape","round","color","secondary",3,"click",4,"ngIf"],["class","ion-margin text-center",4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed",4,"ngIf"],["threshold","100px",3,"ionInfinite",4,"ngIf"],["color","cream",1,"animate__animated","animate__fadeIn"],[1,"text-center"],[3,"innerHTML"],["name","crescent",1,"center3","mt-4"],["tappable","",1,"daListCard","hvr-grow",3,"click"],[3,"src"],["color","light"],[1,"boxshadow"],[4,"ngIf"],["slot","end","color","success",1,"price"],["color","tertiary",1,"ion-margin"],["slot","start","color","dark",1,"rooms"],["name","book","color","secondary"],["shape","round","color","secondary",3,"click"],[1,"ion-margin","text-center"],["color","light",3,"click"],["name","arrow-up-outline"],["vertical","bottom","horizontal","end","slot","fixed"],[3,"routerLink"],["name","cart"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","crescent"]],template:function(t,n){1&t&&(u.Kb(0,"ion-header"),u.Kb(1,"ion-toolbar",0),u.Kb(2,"ion-buttons",1),u.Ib(3,"ion-menu-button"),u.Jb(),u.Kb(4,"ion-title"),u.kc(5),u.Vb(6,"translate"),u.Jb(),u.Jb(),u.Jb(),u.Kb(7,"ion-content"),u.Kb(8,"ion-searchbar",2),u.Sb("ionChange",(function(){return n.criteriaChanged()}))("ngModelChange",(function(t){return n.searchCriteria=t})),u.Vb(9,"translate"),u.Jb(),u.Kb(10,"ion-refresher",3),u.Sb("ionRefresh",(function(t){return n.doRefresh(t)})),u.Ib(11,"ion-refresher-content"),u.Jb(),u.jc(12,m,4,3,"ion-card",4),u.jc(13,C,1,0,"ion-spinner",5),u.Kb(14,"section",6),u.jc(15,M,16,10,"article",7),u.Jb(),u.Kb(16,"div",8),u.jc(17,v,3,3,"ion-button",9),u.Jb(),u.jc(18,_,3,0,"div",10),u.jc(19,I,3,2,"ion-fab",11),u.jc(20,J,2,0,"ion-infinite-scroll",12),u.Jb()),2&t&&(u.xb(5),u.lc(u.Wb(6,11,"app.pages.product.menu")),u.xb(3),u.bc("placeholder",u.Wb(9,13,"app.button.search")),u.ac("debounce",500)("ngModel",n.searchCriteria),u.xb(4),u.ac("ngIf",0===n.searchCriteria.length),u.xb(1),u.ac("ngIf",n.loading),u.xb(2),u.ac("ngForOf",n.daList),u.xb(2),u.ac("ngIf",!n.lastPage&&0===n.searchCriteria.length),u.xb(1),u.ac("ngIf",0===n.searchCriteria.length),u.xb(1),u.ac("ngIf",n.currentUser),u.xb(1),u.ac("ngIf",!n.lastPage))},directives:[a.r,a.R,a.h,a.B,a.Q,a.o,a.H,a.ab,o.h,o.j,a.E,a.F,e.j,e.i,a.i,a.j,a.M,a.t,a.m,a.l,a.f,a.s,a.g,a.p,a.q,a.Y,r.g,a.u,a.v],pipes:[f.c,p.a,e.d],styles:["[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{--background:linear-gradient(135deg,var(--ion-color-light),var(--cream))}ion-card.daListCard[_ngcontent-%COMP%]{position:relative}ion-card.daListCard[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{margin-bottom:-3px}ion-card.daListCard[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-size:30px;top:5%;font-weight:bolder}ion-card.daListCard[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%], ion-card.daListCard[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{position:absolute;left:5%;z-index:2;text-shadow:.5px .5px .5px var(--ion-color-dark)}ion-card.daListCard[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{bottom:5%;font-size:20px}ion-card.daListCard[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{width:100%;position:absolute;z-index:3;bottom:0}ion-card.daListCard[_ngcontent-%COMP%]   .boxshadow[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:0;right:0;z-index:1;box-shadow:inset 0 0 15rem rgba(var(--ion-color-dark-rgb),.33)}ion-card.daListCard[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{right:2%;bottom:20%;position:absolute}ion-card.daListCard[_ngcontent-%COMP%]   .rooms[_ngcontent-%COMP%]{left:0;position:absolute;bottom:0}ion-card.daListCard[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{margin:3px}.cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));grid-gap:1rem;max-width:960px;margin:10px auto 30px}article[_ngcontent-%COMP%]{position:relative}.article-img[_ngcontent-%COMP%]{height:200px;width:100%;-o-object-fit:cover;object-fit:cover}.article-title[_ngcontent-%COMP%]{position:absolute;bottom:0;width:100%;padding:10px;background-color:hsla(0,0%,100%,.7)}.darkBg[_ngcontent-%COMP%]{background-color:rgba(54,27,18,.5)}.viewMoreBtn[_ngcontent-%COMP%]{max-width:200px}.loadMoreBtn[_ngcontent-%COMP%]{display:none}@media screen and (min-width:1319px){.loadMoreBtn[_ngcontent-%COMP%]{display:block}}"]}),t})();var k=i("7JYj");const L=[{path:"",component:K}];let y=(()=>{class t{}return t.\u0275mod=u.Fb({type:t}),t.\u0275inj=u.Eb({factory:function(n){return new(n||t)},imports:[[e.b,o.d,a.S,f.b.forChild(),r.h.forChild(L),k.a]]}),t})()}}]);