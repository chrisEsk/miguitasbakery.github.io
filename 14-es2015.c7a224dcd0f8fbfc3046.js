(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"1fcq":function(t,e,a){"use strict";a.r(e),a.d(e,"CartListPageModule",(function(){return q}));var n=a("ofXK"),i=a("3Pt+"),r=a("tyNb"),s=a("TEn/"),c=a("sYmb"),o=a("7JYj"),l=a("mrSG"),b=a("LvDl"),d=a("R0Ic"),p=a("sybk"),u=a("ul1Q"),g=a("+W2I"),h=a("7K7q"),m=a("2m4Y"),f=a("C13b"),y=a("fXoL"),J=a("otYU");function v(t,e){1&t&&(y.Kb(0,"div",10),y.Kb(1,"h4",11),y.kc(2),y.Vb(3,"translate"),y.Jb(),y.Kb(4,"p"),y.kc(5),y.Vb(6,"translate"),y.Jb(),y.Ib(7,"hr"),y.Kb(8,"p"),y.kc(9),y.Vb(10,"translate"),y.Jb(),y.Jb()),2&t&&(y.xb(2),y.mc(" ",y.Wb(3,3,"app.pages.order.success.header")," "),y.xb(3),y.mc(" ",y.Wb(6,5,"app.pages.order.success.subtitle1")," "),y.xb(4),y.mc(" ",y.Wb(10,7,"app.pages.order.success.subtitle2")," "))}function K(t,e){1&t&&(y.Kb(0,"div",12),y.Kb(1,"h4",11),y.kc(2),y.Vb(3,"translate"),y.Jb(),y.Kb(4,"p"),y.kc(5),y.Vb(6,"translate"),y.Jb(),y.Ib(7,"hr"),y.Kb(8,"p"),y.kc(9),y.Vb(10,"translate"),y.Jb(),y.Jb()),2&t&&(y.xb(2),y.mc(" ",y.Wb(3,3,"app.pages.order.error.header")," "),y.xb(3),y.mc(" ",y.Wb(6,5,"app.pages.order.error.subtitle1")," "),y.xb(4),y.mc(" ",y.Wb(10,7,"app.pages.order.error.subtitle2")," "))}function x(t,e){1&t&&(y.Kb(0,"div",13),y.Kb(1,"p",14),y.kc(2),y.Vb(3,"translate"),y.Jb(),y.Jb()),2&t&&(y.xb(2),y.mc(" ",y.Wb(3,1,"app.pages.cart.isempty")," "))}function k(t,e){if(1&t){const t=y.Lb();y.Kb(0,"div"),y.Kb(1,"ion-button",18),y.Sb("click",(function(){y.fc(t);const e=y.Ub().$implicit;return y.Ub().confirmDeleteEntry(e)})),y.Ib(2,"ion-icon",19),y.Jb(),y.Kb(3,"ion-button",20),y.Sb("click",(function(){y.fc(t);const e=y.Ub().$implicit;return y.Ub().editEntry(e)})),y.Ib(4,"ion-icon",21),y.Jb(),y.Jb()}}function j(t,e){if(1&t&&(y.Kb(0,"ion-item",15),y.Kb(1,"ion-avatar",1),y.Ib(2,"img",16),y.Vb(3,"cloudinaryPipe"),y.Jb(),y.Kb(4,"ion-label"),y.Kb(5,"h2"),y.kc(6),y.Jb(),y.Kb(7,"h3"),y.kc(8),y.Jb(),y.Kb(9,"p"),y.kc(10),y.Vb(11,"translate"),y.Kb(12,"strong"),y.kc(13),y.Jb(),y.Jb(),y.Kb(14,"p"),y.kc(15),y.Vb(16,"translate"),y.Kb(17,"strong"),y.kc(18),y.Vb(19,"number"),y.Jb(),y.Jb(),y.Jb(),y.jc(20,k,5,0,"div",17),y.Jb()),2&t){const t=e.$implicit,a=y.Ub();y.xb(2),y.ac("src",y.Xb(3,8,t.get("product").get("imgUrls")[0],"thumbnail"),y.hc),y.xb(4),y.mc(" ",t.get("product").get("name_es")," "),y.xb(2),y.mc(" ",t.get("product").get("presentation_es")," "),y.xb(2),y.mc(" ",y.Wb(11,11,"app.label.quantity"),": "),y.xb(3),y.lc(t.get("quantity")),y.xb(2),y.mc(" ",y.Wb(16,13,"app.label.price"),": "),y.xb(3),y.mc("\u20a1 ",y.Wb(19,15,t.price),""),y.xb(2),y.ac("ngIf","success"!==a.requestStatus)}}function _(t,e){if(1&t&&(y.Kb(0,"ion-card",22),y.Kb(1,"ion-card-content"),y.Kb(2,"ion-item",23),y.Kb(3,"ion-label",24),y.kc(4),y.Vb(5,"translate"),y.Jb(),y.Kb(6,"ion-badge",25),y.Kb(7,"h3"),y.Kb(8,"strong"),y.kc(9),y.Vb(10,"number"),y.Jb(),y.Jb(),y.Jb(),y.Jb(),y.Jb(),y.Jb()),2&t){const t=y.Ub();y.xb(4),y.mc(" ",y.Wb(5,2,"app.label.total"),": "),y.xb(5),y.mc(" \u20a1 ",y.Wb(10,4,t.totalPrice)," ")}}function I(t,e){if(1&t){const t=y.Lb();y.Kb(0,"ion-button",26),y.Sb("click",(function(){return y.fc(t),y.Ub().proceedToCheckout()})),y.kc(1),y.Vb(2,"translate"),y.Jb()}if(2&t){const t=y.Ub();y.ac("disabled","success"===t.requestStatus),y.xb(1),y.mc(" ",y.Wb(2,2,"app.pages.cart.requestproducts")," ")}}const O=[{path:"",component:(()=>{class t{constructor(t,e,a,n,i,r,s,c,o,l,b){this.route=t,this.router=e,this.translate=a,this.productService=n,this.toastCtrl=i,this.loadingCtrl=r,this.cartService=s,this.authService=c,this.orderService=o,this.alertCtrl=l,this.modalCtrl=b,this.daList=[],this.ionSelectInterfaceOptions={header:this.translate.get("app.label.select-quantity")}}ngOnInit(){}ionViewWillEnter(){return Object(l.a)(this,void 0,void 0,(function*(){const t=yield this.loadingCtrl.create();this.requestStatus="pending",this.loading=!0,t.present(),this.daList=yield this.cartService.GetCart(),Object(b.each)(this.daList,t=>{t.price=t.get("product").get("price_cr")*t.get("quantity")}),this.daList.length>0&&this.calculateTotal(),this.loading=!1,t.dismiss()}))}proceedToCheckout(){return Object(l.a)(this,void 0,void 0,(function*(){const t=yield this.alertCtrl.create({header:this.translate.get("app.pages.cart.proceedtocheckout.header"),message:this.translate.get("app.pages.cart.proceedtocheckout.message"),buttons:[{text:this.translate.get("app.label.cancel"),role:"cancel",cssClass:"secondary",handler:()=>{}},{text:this.translate.get("app.label.accept"),handler:()=>Object(l.a)(this,void 0,void 0,(function*(){const t=yield this.loadingCtrl.create();this.loading=!0,t.present(),this.scrollToTop(),this.prepareOrder(),this.orderService.RequestOrder(this.requestedProducts,this.totalPrice).then(e=>{this.loading=!1,t.dismiss(),console.log("Order requested!",e),this.requestStatus="success",this.cartService.EmptyCart()}).catch(e=>{t.dismiss(),console.error("Order request failed",e),this.requestStatus="failed"})}))}]});yield t.present()}))}calculateTotal(){let t=0;Object(b.each)(this.daList,e=>{t+=e.get("product").get("price_cr")*e.get("quantity")}),this.totalPrice=t}prepareOrder(){this.requestedProducts=Object(b.compact)(Object(b.map)(this.daList,t=>{if(t.get("quantity")>0)return{product_id:t.get("product").id,name:t.get("product").get("name_es"),presentation:t.get("product").get("presentation_es"),quantity:t.get("quantity"),price:t.get("product").get("price_cr")*t.get("quantity"),note:t.get("note"),brands:Object(b.map)(t.get("product").get("brands"),t=>{if(t.get("isActive"))return{id:t.id,name:t.get("name")}}),imgUrl:t.get("product").get("imgUrls")[0]}}))}scrollToTop(){this.content.scrollToTop(1500)}processCartUpdate(t,e){return Object(l.a)(this,void 0,void 0,(function*(){if(yield this.cartService.ProcessCartUpdate(t,e),0===e){const t=yield this.toastCtrl.create({message:this.translate.get("app.pages.cart.deletedentry"),duration:4e3,position:"bottom",buttons:[{icon:"close",side:"end"}]});yield t.present()}}))}editEntry(t){return Object(l.a)(this,void 0,void 0,(function*(){const e=yield this.modalCtrl.create({component:f.a,componentProps:{product:t.get("product")}});return e.onDidDismiss().then(t=>this.ionViewWillEnter()),yield e.present()}))}confirmDeleteEntry(t){return Object(l.a)(this,void 0,void 0,(function*(){const e=yield this.alertCtrl.create({message:this.translate.get("app.pages.cart.confirmdeleteentry"),buttons:[{text:this.translate.get("app.label.cancel"),role:"cancel",cssClass:"secondary",handler:()=>{}},{text:this.translate.get("app.label.accept"),handler:()=>Object(l.a)(this,void 0,void 0,(function*(){const e=yield this.loadingCtrl.create();this.loading=!0,e.present(),this.processCartUpdate(t.get("product"),0).then(t=>{e.dismiss(),this.ionViewWillEnter()})}))}]});yield e.present()}))}}return t.\u0275fac=function(e){return new(e||t)(y.Hb(r.a),y.Hb(r.f),y.Hb(m.a),y.Hb(h.a),y.Hb(s.bb),y.Hb(s.U),y.Hb(u.a),y.Hb(p.a),y.Hb(g.a),y.Hb(s.a),y.Hb(s.W))},t.\u0275cmp=y.Bb({type:t,selectors:[["app-cart-list"]],viewQuery:function(t,e){var a;1&t&&y.oc(s.o,!0),2&t&&y.ec(a=y.Tb())&&(e.content=a.first)},decls:17,vars:10,consts:[["color","primary"],["slot","start"],["defaultHref","/product-list","text",""],["name","cart"],["class","animate__animated animate__fadeInDown alert alert-success ion-margin","role","alert",4,"ngIf"],["class","animate__animated animate__fadeInDown alert alert-danger ion-margin","role","alert",4,"ngIf"],["class","animate__animated animate__fadeInDown alert alert-warning ion-margin","role","alert",4,"ngIf"],["class","noBorderOnLast",4,"ngFor","ngForOf"],["color","cream",4,"ngIf"],["class","ion-margin","size","medium","expand","full","shape","round","color","secondary",3,"disabled","click",4,"ngIf"],["role","alert",1,"animate__animated","animate__fadeInDown","alert","alert-success","ion-margin"],[1,"alert-heading"],["role","alert",1,"animate__animated","animate__fadeInDown","alert","alert-danger","ion-margin"],["role","alert",1,"animate__animated","animate__fadeInDown","alert","alert-warning","ion-margin"],[1,"mt-3"],[1,"noBorderOnLast"],[3,"src"],[4,"ngIf"],["color","danger",3,"click"],["name","trash","slot","icon-only"],["color","warning",3,"click"],["name","create","slot","icon-only"],["color","cream"],["lines","none",1,"ion-no-padding"],[1,"bold"],["color","success"],["size","medium","expand","full","shape","round","color","secondary",1,"ion-margin",3,"disabled","click"]],template:function(t,e){1&t&&(y.Kb(0,"ion-header"),y.Kb(1,"ion-toolbar",0),y.Kb(2,"ion-buttons",1),y.Ib(3,"ion-back-button",2),y.Jb(),y.Kb(4,"ion-title"),y.kc(5),y.Vb(6,"translate"),y.Ib(7,"ion-icon",3),y.Jb(),y.Jb(),y.Jb(),y.Kb(8,"ion-content"),y.jc(9,v,11,9,"div",4),y.jc(10,K,11,9,"div",5),y.jc(11,x,4,3,"div",6),y.Kb(12,"div"),y.Kb(13,"ion-list"),y.jc(14,j,21,17,"ion-item",7),y.Jb(),y.Jb(),y.jc(15,_,11,6,"ion-card",8),y.jc(16,I,3,4,"ion-button",9),y.Jb()),2&t&&(y.xb(5),y.mc(" ",y.Wb(6,8,"app.label.cart")," "),y.xb(4),y.ac("ngIf","success"===e.requestStatus),y.xb(1),y.ac("ngIf","failed"===e.requestStatus),y.xb(1),y.ac("ngIf",0===(null==e.daList?null:e.daList.length)&&!e.loading),y.xb(1),y.ac("@staggerIn",null==e.daList?null:e.daList.length),y.xb(2),y.ac("ngForOf",e.daList),y.xb(1),y.ac("ngIf",(null==e.daList?null:e.daList.length)>0),y.xb(1),y.ac("ngIf",(null==e.daList?null:e.daList.length)>0))},directives:[s.r,s.R,s.h,s.d,s.e,s.Q,s.s,s.o,n.j,s.z,n.i,s.x,s.c,s.y,s.g,s.i,s.j,s.f],pipes:[c.c,J.a,n.d],styles:[""],data:{animation:[Object(d.k)("staggerIn",[Object(d.j)("* => *",[Object(d.f)(":enter",Object(d.i)({opacity:0,transform:"translate3d(0,10px,0)"}),{optional:!0}),Object(d.f)(":enter",Object(d.h)("300ms",[Object(d.e)("600ms",Object(d.i)({opacity:1,transform:"translate3d(0,0,0)"}))]),{optional:!0})])])]}}),t})()}];let q=(()=>{class t{}return t.\u0275mod=y.Fb({type:t}),t.\u0275inj=y.Eb({factory:function(e){return new(e||t)},imports:[[n.b,i.d,s.S,r.h.forChild(O),c.b.forChild(),o.a]]}),t})()}}]);